---
title: "HW 01"
author: "INSERT YOUR NAME HERE"
format: 
  html:
    embed-resources: true
toc: true
---

## 0 - Setup

```{r setup}
if (!require("pacman")) 
  install.packages("pacman")

# use this line for installing/loading
# pacman::p_load() 

devtools::install_github("tidyverse/dsbox")
install.packages("readr")
install.packages("tidyverse")
library("readr")
library("tidyverse")
```

## 1 - Road traffic accidents in Edinburgh

```{r label-me-1}

accidents <- read_csv("data/accidents.csv")
```
```{r}
accidents2 <- accidents[c("day_of_week", "time", "severity")]
accidents2 <- accidents2 %>% group_by(day_of_week) %>% mutate(is_weekend = if(any(day_of_week=='Sunday' 
                                                                   | day_of_week == 'Saturday'))  "Weekend" else "Weekday")

g <- ggplot(accidents2, aes(x=time, group=severity, fill=severity))
g <- g + geom_density(alpha=0.7)  + facet_wrap(~is_weekend, nrow=2)
g <- g + labs(x="Time of day", y="Density", title="Number of accidents throughout the day", subtitle="By day of week and severity") +  
  scale_fill_manual("severity", name="Severity", values = c("Fatal"="#A694AE","Serious"= "#A7C9C7", "Slight"="#FCF3A9"))
g <- g + theme_minimal() 


g
# A694AE = fatal, FCF3A9 = slight, A7C9C7 = serious
```

## 2 - NYC marathon winners

### 2a
We see that with the two plots below, there is a better understanding of outliers when viewing the box plot. However, in the histogram, there appear to be two distributions: a high number of runners around the 2 hour mark, and another high number of runners around the 2:30 mark. This is not seen in the boxplot, which only shows the mean of the entire dataset. 

```{r label-me-2}
nyc <- read_csv("data/nyc_marathon.csv")
# glimpse(nyc)
g <- ggplot(nyc, aes(x=time)) +  geom_histogram(alpha=0.9, fill="lightblue") + theme_minimal()
g <- g + labs(x="Total Time", y="Frequency", title = "NYC Marathon winner times, 1970-2000")
g
```


```{r}
g <- ggplot(nyc, aes(x=time)) +  geom_boxplot(alpha=0.9, fill="lightblue") + theme_minimal()
g <- g + labs(x="Total Time", title = "NYC Marathon winner times, 1970-2000")
g
```
### 2b
When stratifying by gender, we find that the reason for two distributions as seen from the histogram above is due to difference in performance by gender. Women have a higher winning time than men. 
```{r}
g <- ggplot(nyc, aes(y=time, color=division)) + geom_boxplot() + scale_color_manual(values=c("#E69F00", "#7aa9a9" ))
g <- g + theme_minimal() + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + labs(y="Time", title="NYC Marathon winners 1970-2000 comparison via Men and Women")
g 
```

## 3 - US counties

## 4 - Rental apartments in SF

## 5 - Napoleonâ€™s march.
